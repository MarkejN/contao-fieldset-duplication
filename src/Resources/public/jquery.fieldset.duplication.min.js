!function(s){"use strict";s.fn.fieldsetDuplication=function(t){var r=s.extend({},{prepend:!1,buttonAdd:"+",buttonRemove:"&times;"},t);return s(this).each(function(t,e){var n=s(this),d=null,i=null,a=n.attr("class").split(/\s+/);s.each(a,function(t,e){if(e.match(/duplicate-fieldset-/))return i="."+e,!1});var o=function(){(d=s(i)).each(function(t,e){var n=s(this);n.removeClass("last"),n.removeClass("first"),0==t&&n.addClass("first"),t==d.length-1&&n.addClass("last"),l(n),n.hasClass("duplicate")?n.find(".duplication-buttons button.duplication-button--remove").show():n.find(".duplication-buttons button.duplication-button--remove").hide()})},u=function(t){t.find(".duplication-buttons button.duplication-button--add").off("click").on("click",function(t){return t.preventDefault(),function(t){if(!(50<=d.length)){var e=t.clone();e.find("input[name], select[name], textarea[name]").each(function(){var t=s(this);t.removeClass("error");var e=d.length+1,n=t.attr("id");if(void 0!==n){0<=(o=n.indexOf("_duplicate_"))&&(n=n.substr(0,o));var i=n+"_duplicate_"+e;t.closest(".widget").find('label[for="'+t.attr("id")+'"]').each(function(){var t=s(this);t.attr("for",i),void 0!==t.attr("id")&&t.attr("id",t.attr("id")+"_duplicate_"+e)}),t.attr("id",i)}var a=t.attr("name");if(void 0!==a){var o;0<=(o=a.indexOf("_duplicate_"))&&(a=a.substr(0,o));var u=a+"_duplicate_"+e;t.attr("name",u)}t.val()&&t.val()!==t.attr("value")&&t.val(""),t.not("[checked]").prop("checked",!1)}),e.find("label").removeClass("error"),e.find("p.error").remove(),e.find(".widget").removeClass("error"),e.addClass("duplicate"),u(e),t.after(e),o(),s(document).trigger("fieldset-cloned",[e])}}(s(this).closest("fieldset")),!1}),t.hasClass("duplicate")&&t.find(".duplication-buttons button.duplication-button--remove").off("click").on("click",function(t){var e;return t.preventDefault(),e=s(this).closest("fieldset"),1<d.length&&e.hasClass("duplicate")&&(e.remove(),o()),!1})},l=function(t){t.find(".duplication-buttons").remove();var e=s('<div class="duplication-buttons"></div>'),n=s('<button type="button" class="duplication-button duplication-button--add">'+r.buttonAdd+"</button>");e.append(n);var i=s('<button type="button" class="duplication-button duplication-button--remove">'+r.buttonRemove+"</button>");e.append(i),r.prepend?t.prepend(e):t.append(e),u(t)};o()}),this}}(jQuery);