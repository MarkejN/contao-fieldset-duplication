!function(r){"use strict";r.fn.fieldsetDuplication=function(t){var d=r.extend({},{prepend:!1,buttonAdd:"+",buttonRemove:"&times;"},t);return r(this).each(function(t,n){var e=r(this),a=null,i=null,o=e.attr("class").split(/\s+/);r.each(o,function(t,n){if(n.match(/duplicate-fieldset-/))return i="."+n,!1});var u=function(){(a=r(i)).each(function(t,n){var e=r(this);e.removeClass("last"),e.removeClass("first"),0==t&&e.addClass("first"),t==a.length-1&&e.addClass("last"),s(e),e.hasClass("duplicate")?e.find(".duplication-buttons button.duplication-button--remove").show():e.find(".duplication-buttons button.duplication-button--remove").hide()})},l=function(t){t.find(".duplication-buttons button.duplication-button--add").off("click").on("click",function(t){return t.preventDefault(),function(t){if(!(50<=a.length)){var n=t.clone();n.find("input[name], select[name], textarea[name]").each(function(){var t=r(this);t.removeClass("error");var n=a.length+1,e=t.attr("id")+"_duplicate_"+n;t.attr("id",e);var i=t.attr("name")+"_duplicate_"+n;t.attr("name",i),t.closest(".widget").find("label").each(function(){r(this).attr("for",e)}),t.val()&&t.val("")}),n.find("label").removeClass("error"),n.find("p.error").remove(),n.find(".widget").removeClass("error"),n.addClass("duplicate"),l(n),t.after(n),u(),r(document).trigger("fieldset-cloned",[n])}}(r(this).closest("fieldset")),!1}),t.hasClass("duplicate")&&t.find(".duplication-buttons button.duplication-button--remove").off("click").on("click",function(t){var n;return t.preventDefault(),n=r(this).closest("fieldset"),1<a.length&&n.hasClass("duplicate")&&(n.remove(),u()),!1})},s=function(t){t.find(".duplication-buttons").remove();var n=r('<div class="duplication-buttons"></div>'),e=r('<button type="button" class="duplication-button duplication-button--add">'+d.buttonAdd+"</button>");n.append(e);var i=r('<button type="button" class="duplication-button duplication-button--remove">'+d.buttonRemove+"</button>");n.append(i),d.prepend?t.prepend(n):t.append(n),l(t)};u()}),this}}(jQuery);